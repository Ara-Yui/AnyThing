var m=Object.defineProperty;var _=(n,e,t)=>e in n?m(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var i=(n,e,t)=>(_(n,typeof e!="symbol"?e+"":e,t),t);import{b as u,f as l,l as g,aw as f,_ as w,r as k,e as y,g as c,w as h,h as x,u as p,aB as T,T as v}from"./vendor-a3ce1f9d.js";import{A as b,u as C}from"./index-ce014a4f.js";import{_ as H}from"./plugin-vue_export-helper-c27b6911.js";const P={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},L=f('<g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 6V3"></path><path d="M16.25 7.75L18.4 5.6"></path><path d="M18 12h3"></path><path d="M16.25 16.25l2.15 2.15"></path><path d="M12 18v3"></path><path d="M7.75 16.25L5.6 18.4"></path><path d="M6 12H3"></path><path d="M7.75 7.75L5.6 5.6"></path></g>',1),M=[L],W=u({name:"Loader",render:function(e,t){return l(),g("svg",P,M)}});class B{constructor(e){i(this,"loading",!1);i(this,"headers",{});i(this,"controller",new AbortController);i(this,"timeout",5*1e3);this.loading=e||!1,this.headers={"Content-Type":"application/json"}}request(e,t,s){return new Promise((o,r)=>{this.loading&&r("请求正在进行中，请稍后再试"),this.loading=!0,this.timeoutHandler(),fetch(e,{method:t,body:JSON.stringify(s),headers:this.headers,signal:this.controller.signal}).then(a=>{if(this.loading=!1,a.ok)return a.json();r(a.statusText)}).then(a=>{o(a.data)}).catch(a=>{this.errorHandler(a),r(a)})})}timeoutHandler(){this.timeout>0&&setTimeout(()=>{this.loading=!1,this.controller.abort()},this.timeout)}errorHandler(e){this.loading=!1,this.controller.abort()}async get(e,t){return await this.request(e,"GET",t)}async post(e,t){return await this.request(e,"POST",t)}async put(e,t){return await this.request(e,"PUT",t)}async delete(e,t){return await this.request(e,"DELETE",t)}setHeaders(e){return this.headers={...this.headers,...e},this}clearHeaders(){return this.headers={},this}deleteHeader(e){return delete this.headers[e],this}setTimeout(e){return this.timeout=e,this}cancel(){return this.controller.abort(),this}}const E=B,q=()=>{async function n(){const{rawSrc:t}=await new E().get("https://api.wetab.link/api/wallpaper/next?type=random");return t}async function e(t){const s=await n(),o=new Image;return o.src=s,new Promise((r,a)=>{o.onload=()=>{const d=`
        background-image: url(${s});
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
      `;t.style.cssText=d,r()},o.onerror=()=>{a()}})}return{getRandomWallpaper:n,setRandomWallpaperToDom:e}};const A=u({__name:"WallPaperQuick",setup(n){const e=b.asyncComponent(()=>w(()=>import("./ToolBarIconContain-a571e8ff.js"),["./ToolBarIconContain-a571e8ff.js","./plugin-vue_export-helper-c27b6911.js","./vendor-a3ce1f9d.js","./vendor-e98c73d8.css","./ToolBarIconContain-0fa391c5.css"],import.meta.url)),t=k(!1);async function s(){if(t.value)return;t.value=!0;const{getRandomWallpaper:o}=q(),r=await o();C().DesktopConfig.setDesktopBackgroudImg(r,t)}return(o,r)=>{const a=y("n-icon");return l(),c(p(e),{class:"wallpaper_quick",onClick:s},{default:h(()=>[x(v,{name:"wallpaper"},{default:h(()=>[t.value?(l(),c(a,{key:0,class:"loading icon",component:p(W)},null,8,["component"])):(l(),c(a,{key:1,class:"icon",component:p(T)},null,8,["component"]))]),_:1})]),_:1})}}}),V=H(A,[["__scopeId","data-v-b6dc6b98"]]);export{V as default};
